

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pydfnworks.dfnGen.lagrit_scripts &mdash; dfnWorks 2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index_docs.html" class="icon icon-home"> dfnWorks
          

          
            
            <img src="../../../_static/dfnworks_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                2.2, LANL, Docs: LA-UR-17-22216, Software: LA-CC-17-027
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Settting up dfnWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../applications.html">Example Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">dfnWorks Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pydfnworks.html">pydfnworks: the dfnWorks python package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dfngen.html">dfnGen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dfnflow.html">dfnFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dfntrans.html">dfnTrans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../output.html">Output files</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index_docs.html">dfnWorks</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index_docs.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pydfnworks.dfnGen.lagrit_scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pydfnworks.dfnGen.lagrit_scripts</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: lagrit_scripts.py</span>
<span class="sd">   :synopsis: create lagrit scripts for meshing dfn using LaGriT </span>
<span class="sd">.. moduleauthor:: Jeffrey Hyman &lt;jhyman@lanl.gov&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="k">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">rmtree</span><span class="p">,</span> <span class="n">move</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">genfromtxt</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">arcsin</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<div class="viewcode-block" id="edit_intersection_files"><a class="viewcode-back" href="../../../pydfnworks.html#pydfnworks.dfnGen.lagrit_scripts.edit_intersection_files">[docs]</a><span class="k">def</span> <span class="nf">edit_intersection_files</span><span class="p">(</span><span class="n">num_poly</span><span class="p">,</span> <span class="n">fracture_list</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; If pruning a DFN, this function walks through the intersection files</span>
<span class="sd">    and removes references to files that are not included in the </span>
<span class="sd">    fractures that will remain in the network.</span>
<span class="sd"> </span>
<span class="sd">    Parameters</span>
<span class="sd">    ---------</span>
<span class="sd">        num_poly : int </span>
<span class="sd">            Number of Fractures in the original DFN</span>
<span class="sd">        fracture_list :list of int</span>
<span class="sd">            List of fractures to keep in the DFN</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1. Currently running in serial, but it could be parallelized</span>
<span class="sd">    2. Assumes the pruning directory is not the original directory</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Make list of connectivity.dat</span>
    <span class="n">connectivity</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;connectivity.dat&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_poly</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">frac</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frac</span><span class="p">))</span>
        <span class="n">connectivity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">fractures_to_remove</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_poly</span><span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">fracture_list</span><span class="p">))</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;intersections&#39;</span><span class="p">)</span>
    <span class="c1"># clean up directory </span>
    <span class="c1">#fl_list = glob.glob(&quot;*prune.inp&quot;)</span>
    <span class="c1">#for fl in fl_list: </span>
    <span class="c1">#   os.remove(fl)    </span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Editing Intersection Files&quot;</span><span class="p">)</span>    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fracture_list</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;intersections_</span><span class="si">%d</span><span class="s1">.inp&#39;</span><span class="o">%</span><span class="n">i</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; Working on: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">intersecting_fractures</span> <span class="o">=</span> <span class="n">connectivity</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pull_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">intersecting_fractures</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">fractures_to_remove</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pull_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Create Symlink to origignal intersection file</span>
            <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;intersections/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="c1"># Create LaGriT script to remove intersections with fractures not in prune_file</span>
            <span class="n">lagrit_script</span> <span class="o">=</span> <span class="s1">&#39;read / </span><span class="si">%s</span><span class="s1"> / mo1&#39;</span><span class="o">%</span><span class="n">filename</span>
            <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">pset / pset2remove / attribute / b_a / 1,0,0 / eq / </span><span class="si">%d</span><span class="s1"></span>
<span class="s1">    &#39;&#39;&#39;</span><span class="o">%</span><span class="n">pull_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">pull_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">pset / prune / attribute / b_a / 1,0,0 / eq / </span><span class="si">%d</span><span class="s1"></span>
<span class="s1">pset / pset2remove / union / pset2remove, prune</span>
<span class="s1">#rmpoint / pset, get, prune</span>
<span class="s1">pset / prune / delete</span>
<span class="s1">     &#39;&#39;&#39;</span><span class="o">%</span><span class="n">j</span>
            <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">rmpoint / pset, get, pset2remove </span>
<span class="s1">rmpoint / compress</span>
<span class="s1">    </span>
<span class="s1">cmo / modatt / mo1 / imt / ioflag / l</span>
<span class="s1">cmo / modatt / mo1 / itp / ioflag / l</span>
<span class="s1">cmo / modatt / mo1 / isn / ioflag / l</span>
<span class="s1">cmo / modatt / mo1 / icr / ioflag / l</span>
<span class="s1">    </span>
<span class="s1">cmo / status / brief</span>
<span class="s1">dump / intersections_</span><span class="si">%d</span><span class="s1">_prune.inp / mo1</span>
<span class="s1">finish</span>

<span class="s1">&#39;&#39;&#39;</span><span class="o">%</span><span class="n">i</span>
            
            <span class="n">lagrit_filename</span> <span class="o">=</span> <span class="s1">&#39;prune_intersection.lgi&#39;</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">lagrit_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;LAGRIT_EXE&#39;</span><span class="p">]</span> <span class="o">+</span> \
                <span class="s1">&#39;&lt; prune_intersection.lgi &gt; out_</span><span class="si">%d</span><span class="s1">.txt&#39;</span><span class="o">%</span><span class="n">i</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">move</span><span class="p">(</span><span class="s2">&quot;intersections_</span><span class="si">%d</span><span class="s2">_prune.inp&quot;</span><span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;intersections_</span><span class="si">%d</span><span class="s2">.inp&quot;</span><span class="o">%</span><span class="n">i</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">copy</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;intersections/&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span></div>


<div class="viewcode-block" id="create_parameter_mlgi_file"><a class="viewcode-back" href="../../../pydfnworks.html#pydfnworks.dfnGen.lagrit_scripts.create_parameter_mlgi_file">[docs]</a><span class="k">def</span> <span class="nf">create_parameter_mlgi_file</span><span class="p">(</span><span class="n">fracture_list</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">refine_dist</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create parameteri.mlgi files used in running LaGriT Scripts</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        num_poly : int</span>
<span class="sd">            Number of polygons</span>
<span class="sd">        h : float </span>
<span class="sd">            Meshing length scale</span>
<span class="sd">        slope : float </span>
<span class="sd">            Slope of coarsening function, default = 2</span>
<span class="sd">        refine_dist : float </span>
<span class="sd">            Distance used in coarsening function, default = 0.5</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Set slope = 0 for uniform mesh</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--&gt; Creating parameter*.mlgi files&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span>    
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">)</span>

    <span class="c1"># Extrude and Translate computation</span>
    <span class="c1"># Parameters, delta: buffer zone, amount of h/2 we remove from around line</span>
    <span class="c1"># h_extrude height of rectangle extruded from line of intersection</span>
    <span class="c1"># r_radius: Upper bound on radius of circumscribed circle around rectangle</span>
    <span class="c1"># h_trans : amount needed to translate to create delta buffer</span>
    <span class="c1"># It&#39;s  just a little trig! </span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mf">0.75</span>
    <span class="n">h_extrude</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span> <span class="c1"># upper limit on spacing of points on interssction line</span>
    <span class="n">h_radius</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h_extrude</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h_extrude</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">h_trans</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">h_extrude</span> <span class="o">+</span> <span class="n">h_radius</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">arcsin</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span>

    <span class="c1">#Go through the list and write out parameter file for each polygon</span>
    <span class="c1">#to be an input file for LaGriT</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="s1">&#39;poly_info.dat&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fracture_list</span><span class="p">):</span> 
        <span class="c1"># using i - 1 do to python indexing from 0</span>
        <span class="c1"># fracture index starts at 1</span>
        <span class="n">frac_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">long_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>      
        <span class="n">theta</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>    
        <span class="n">x1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>    
        <span class="n">y1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>    
        <span class="n">z1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>    
        <span class="n">x2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>    
        <span class="n">y2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>    
        <span class="n">z2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>    
        <span class="n">family</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">fparameter_name</span> <span class="o">=</span> <span class="s1">&#39;parameters/parameters_&#39;</span> <span class="o">+</span> <span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39;.mlgi&#39;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fparameter_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / ID / &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / OUTFILE_GMV / mesh_&#39;</span> <span class="o">+</span> <span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39;.gmv</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / OUTFILE_AVS / mesh_&#39;</span> <span class="o">+</span> <span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39;.inp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / OUTFILE_LG / mesh_&#39;</span> <span class="o">+</span> <span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39;.lg</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / POLY_FILE / poly_&#39;</span> <span class="o">+</span> <span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39;.inp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / QUAD_FILE / tmp_quad_&#39;</span> <span class="o">+</span> <span class="n">frac_id</span> <span class="o">+</span> <span class="s1">&#39;.inp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / EXCAVATE_FILE / tmp_excavate_&#39;</span> <span class="o">+</span> <span class="n">frac_id</span> <span class="o">+</span> <span class="s1">&#39;.inp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PRE_FINAL_FILE / tmp_pre_final_&#39;</span><span class="o">+</span><span class="n">frac_id</span> <span class="o">+</span> <span class="s1">&#39;.inp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PRE_FINAL_MASSAGE / tmp_pre_final_massage_&#39;</span> <span class="o">+</span> <span class="n">frac_id</span> <span class="o">+</span><span class="s1">&#39;.gmv</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">h</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_EPS / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE2 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_EXTRUDE / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">h_extrude</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_TRANS / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">h_trans</span><span class="p">))</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_PRIME / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">0.8</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_PRIME2 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">0.3</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE3 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">3.0</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE8 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">8.0</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE16 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">16.0</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE32 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">32.0</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / H_SCALE64 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="mf">64.0</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PERTURB8 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mf">0.05</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PERTURB16 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mi">16</span><span class="o">*</span><span class="mf">0.05</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PERTURB32 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mi">32</span><span class="o">*</span><span class="mf">0.05</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PERTURB64 / </span><span class="si">%e</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mi">64</span><span class="o">*</span><span class="mf">0.05</span><span class="o">*</span><span class="n">h</span><span class="p">))</span>

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PARAM_A / </span><span class="si">%f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">slope</span><span class="p">)</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PARAM_B / </span><span class="si">%f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">slope</span><span class="o">*</span><span class="n">refine_dist</span><span class="p">)))</span>    

        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PARAM_A2 / </span><span class="si">%f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">slope</span><span class="p">))</span>    
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / PARAM_B2 / </span><span class="si">%f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">slope</span><span class="o">*</span><span class="n">refine_dist</span><span class="p">)))</span>    
        
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / THETA  / </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / X1 /  </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">x1</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / Y1 / </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">y1</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / Z1 / </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">z1</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / X2 / </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">x2</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / Y2 / </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">y2</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / Z2 / </span><span class="si">%0.12f</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">z2</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;define / FAMILY / </span><span class="si">%d</span><span class="s1"> </span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">family</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;finish </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Creating parameter*.mlgi files: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_lagrit_scripts"><a class="viewcode-back" href="../../../pydfnworks.html#pydfnworks.dfnGen.lagrit_scripts.create_lagrit_scripts">[docs]</a><span class="k">def</span> <span class="nf">create_lagrit_scripts</span><span class="p">(</span><span class="n">visual_mode</span><span class="p">,</span> <span class="n">ncpu</span><span class="p">,</span> <span class="n">refine_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">production_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> 
    <span class="sd">&quot;&quot;&quot; Creates LaGriT script to be mesh each polygon</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ---------- </span>
<span class="sd">        visual_mode : bool </span>
<span class="sd">            Sets if running if visual mode or in full dump</span>
<span class="sd">        ncpu : int</span>
<span class="sd">            Number of cpus</span>
<span class="sd">        refine_factor : int </span>
<span class="sd">            Number of times original polygon gets refined </span>
<span class="sd">        production_mode : bool</span>
<span class="sd">            Determines if clean up of work files occurs on the fly. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1. Only ncpu of these files are created</span>
<span class="sd">    2. Symbolic links are used to rotate through fractures on different CPUs </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#Section 2 : Creates LaGriT script to be run for each polygon</span>
    <span class="c1">#Switches to control the LaGriT output</span>
    <span class="c1">#Network visualization mode True ouputs the triangulated mesh</span>
    <span class="c1">#for each fracture without any refinement. The goal is to visualize</span>
    <span class="c1">#the network structure instead of outputing the appropriate values</span>
    <span class="c1">#for computation</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Writing LaGriT Control Files&quot;</span><span class="p">)</span>
    <span class="c1">#Go through the list and write out parameter file for each polygon</span>
    <span class="c1">#to be an input file for LaGriT</span>

    <span class="n">lagrit_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;infile </span><span class="si">%s</span><span class="s2"> </span>
<span class="s2">#LaGriT Script</span>
<span class="s2"># Name the input files that contain the polygons </span>
<span class="s2"># and lines of intersection. </span>

<span class="s2">define / POLY_FILE / </span><span class="si">%s</span><span class="s2"> </span>
<span class="s2">define / LINE_FILE / </span><span class="si">%s</span><span class="s2"> </span>
<span class="s2">define / OUTPUT_INTER_ID_SSINT / id_tri_node_CPU</span><span class="si">%d</span><span class="s2">.list</span>

<span class="s2"># Define parameters such as: </span>
<span class="s2"># length scale to refine triangular mesh  </span>
<span class="s2"># purturbation distance to break symmetry of refined mesh# </span>

<span class="s2"># Read in line and polygon files  </span>
<span class="s2">read / POLY_FILE / mo_poly_work</span>
<span class="s2">&quot;&quot;&quot;</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visual_mode</span><span class="p">:</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">read / LINE_FILE / mo_line_work </span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="c1"># START: Refine the point distribution</span>
    <span class="c1">#</span>
    <span class="k">if</span><span class="p">(</span><span class="n">refine_factor</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s1">&#39;extrude / mo_quad_work / mo_line_work / const / H_SCALE8 / volume / 0. 0. 1.  </span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">refine_factor</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s1">&#39;refine/constant/imt1/linear/element/1 0 0 /-1.,0.,0./inclusive amr 2  </span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">refine_factor</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s1">&#39;refine/constant/imt1/linear/element/1 0 0 /-1.,0.,0./inclusive amr 2  </span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s1">&#39;refine/constant/imt1/linear/element/1 0 0 /-1.,0.,0./inclusive amr 2  </span><span class="se">\n</span><span class="s1">&#39;</span>
            
        <span class="k">if</span> <span class="p">(</span><span class="n">refine_factor</span> <span class="o">==</span> <span class="mi">8</span><span class="p">):</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span><span class="s1">&#39;refine/constant/imt1/linear/element/1 0 0 /-1.,0.,0./inclusive amr 2  </span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span><span class="s1">&#39;refine/constant/imt1/linear/element/1 0 0 /-1.,0.,0./inclusive amr 2  </span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span><span class="s1">&#39;refine/constant/imt1/linear/element/1 0 0 /-1.,0.,0./inclusive amr 2  </span><span class="se">\n</span><span class="s1">&#39;</span>
            
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span>
<span class="s2">grid2grid / tree_to_fe / mo_quad_work / mo_quad_work  </span>
<span class="s2">extract/surfmesh/1,0,0/mo_ext_work/mo_quad_work/external </span>
<span class="s2">compute / distance_field / mo_ext_work / mo_line_work / dfield </span>
<span class="s2">pset / pdel_work / attribute / dfield / 1 0 0 / H_SCALE3 / gt </span>
<span class="s2">rmpoint / pset get pdel_work / inclusive </span>
<span class="s2">rmpoint / compress  </span>

<span class="s2">cmo / delete / mo_quad_work </span>
<span class="s2">cmo / delete / mo_line_work</span>
<span class="s2">cmo / move / mo_line_work / mo_ext_work </span>
<span class="s2">rmpoint / compress  </span>
<span class="s2">&quot;&quot;&quot;</span>    
        <span class="c1"># END: Refine the point distribution</span>
        <span class="c1">#</span>
    <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">## Triangulate Fracture without point addition </span>
<span class="s2">cmo / create / mo_pts / / / triplane </span>
<span class="s2">copypts / mo_pts / mo_poly_work </span>
<span class="s2">cmo / select / mo_pts </span>
<span class="s2">triangulate / counterclockwise </span>

<span class="s2">cmo / setatt / mo_pts / imt / 1 0 0 / ID </span>
<span class="s2">cmo / setatt / mo_pts / itetclr / 1 0 0 / ID </span>
<span class="s2">resetpts / itp </span>
<span class="s2">cmo / delete / mo_poly_work </span>
<span class="s2">cmo / select / mo_pts </span>

<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visual_mode</span><span class="p">:</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Creates a Coarse Mesh and then refines it using the distance field from intersections</span>
<span class="s2">massage / H_SCALE64 / H_EPS  / H_EPS</span>
<span class="s2">recon 0; smooth;recon 0;smooth;recon 0;smooth;recon 0</span>
<span class="s2">resetpts / itp</span>
<span class="s2">pset / p_move / attribute / itp / 1 0 0 / 0 / eq</span>
<span class="s2">perturb / pset get p_move / PERTURB64 PERTURB64 0.0</span>
<span class="s2">recon 0; smooth;recon 0;smooth;recon 0;smooth;recon 0</span>
<span class="s2">smooth;recon 0;smooth;recon 0;smooth;recon 0</span>

<span class="s2">massage / H_SCALE32 / H_EPS / H_EPS</span>
<span class="s2">resetpts / itp</span>
<span class="s2">pset / p_move / attribute / itp / 1 0 0 / 0 / eq</span>
<span class="s2">perturb / pset get p_move / PERTURB32 PERTURB32 0.0</span>
<span class="s2">recon 0; smooth;recon 0;smooth;recon 0;smooth;recon 0</span>
<span class="s2">smooth;recon 0;smooth;recon 0;smooth;recon 0</span>

<span class="s2">massage / H_SCALE16 / H_EPS  / H_EPS</span>
<span class="s2">resetpts / itp</span>
<span class="s2">pset / p_move / attribute / itp / 1 0 0 / 0 / eq</span>
<span class="s2">perturb / pset get p_move / PERTURB16 PERTURB16 0.0</span>
<span class="s2">recon 0; smooth;recon 0;smooth;recon 0;smooth;recon 0</span>
<span class="s2">smooth;recon 0;smooth;recon 0;smooth;recon 0</span>

<span class="s2">massage / H_SCALE8 / H_EPS / H_EPS</span>
<span class="s2">resetpts / itp</span>
<span class="s2">pset / p_move / attribute / itp / 1 0 0 / 0 / eq</span>
<span class="s2">perturb / pset get p_move / PERTURB8 PERTURB8 0.0</span>
<span class="s2">recon 0; smooth;recon 0;smooth;recon 0;smooth;recon 0</span>
<span class="s2">smooth;recon 0;smooth;recon 0;smooth;recon 0</span>

<span class="s2">cmo/addatt/ mo_pts /x_four/vdouble/scalar/nnodes </span>
<span class="s2">cmo/addatt/ mo_pts /fac_n/vdouble/scalar/nnodes </span>

<span class="s2"># Massage points based on linear function down to h_prime</span>
<span class="s2">massage2/user_function2.lgi/H_PRIME/fac_n/1.e-5/1.e-5/1 0 0/strictmergelength </span>

<span class="s2">assign///maxiter_sm/1 </span>
<span class="s2">smooth;recon 0;smooth;recon 0;smooth;recon 0</span>

<span class="s2">assign///maxiter_sm/10</span>

<span class="s2">massage2/user_function.lgi/H_PRIME/fac_n/1.e-5/1.e-5/1 0 0/strictmergelength </span>
<span class="s2">cmo / DELATT / mo_pts / rf_field_name </span>

<span class="s2"># Extrude and excavate the lines of intersection</span>
<span class="s2">cmo / select / mo_line_work </span>

<span class="s2">extrude / mo_quad / mo_line_work / const / H_EXTRUDE / volume / 0. 0. 1. </span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">production_mode</span><span class="p">:</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">dump / avs / QUAD_FILE / mo_quad </span>
<span class="s2">cmo / delete / mo_quad </span>
<span class="s2">read / QUAD_FILE / mo_quad </span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s1">&#39;cmo / select / mo_quad </span><span class="se">\n</span><span class="s1">&#39;</span>
        
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Translate extruced lines of intersectino down slightly to excavate </span>
<span class="s2"># nearby points from the mesh </span>

<span class="s2">trans / 1 0 0 / 0. 0. 0. / 0. 0. H_TRANS</span>
<span class="s2">hextotet / 2 / mo_tri / mo_quad </span>
<span class="s2">cmo / delete / mo_quad </span>
<span class="s2">addmesh / excavate / mo_excavate / mo_pts / mo_tri</span>

<span class="s2">##### DEBUG #####</span>
<span class="s2"># If meshing fails, uncomment and rerun the script to get tmp meshes, </span>
<span class="s2"># which are otherwise not output </span>
<span class="s2">#dump / avs2 / tmp_tri.inp / mo_tri / 1 1 1 0</span>
<span class="s2">#dump / avs2 / tmp_pts.inp / mo_pts / 1 1 1 0</span>
<span class="s2">#dump / avs2 / tmp_excavate.inp / mo_excavate / 1 1 1 0</span>
<span class="s2">#finish</span>
<span class="s2">#####</span>
<span class="s2"> </span>
<span class="s2">cmo / delete / mo_tri </span>
<span class="s2">cmo / delete / mo_pts </span>

<span class="s2"># recompute dfield </span>
<span class="s2">cmo / create / mo_final / / / triplane </span>
<span class="s2">copypts / mo_final / mo_excavate  </span>
<span class="s2">compute / distance_field / mo_final / mo_line_work / dfield </span>
<span class="s2">cmo / printatt / mo_final / dfield / minmax </span>
<span class="s2">pset / pdel / attribute dfield / 1,0,0 / lt H_PRIME2 </span>
<span class="s2">rmpoint / pset,get,pdel / inclusive  </span>
<span class="s2">rmpoint / compress  </span>

<span class="s2">copypts / mo_final / mo_line_work  </span>

<span class="s2">cmo / select / mo_final </span>
<span class="s2">cmo / setatt / mo_final / imt / 1 0 0 / ID </span>
<span class="s2">cmo / setatt / mo_final / itp / 1 0 0 / 0 </span>
<span class="s2">cmo / setatt / mo_final / itetclr / 1 0 0 / ID </span>
<span class="s2"># cmo / printatt / mo_final / -xyz- / minmax </span>
<span class="s2">trans/ 1 0 0 / zero / xyz </span>
<span class="s2">cmo / setatt / mo_final / zic / 1 0 0 / 0.0 </span>
<span class="s2">cmo / printatt / mo_final / -xyz- / minmax </span>
<span class="s2">connect </span>

<span class="s2">trans / 1 0 0 / original / xyz </span>
<span class="s2">cmo / printatt / mo_final / -xyz- / minmax </span>

<span class="s2">#cmo / delete / mo_line_work </span>
<span class="s2">cmo / delete / mo_excavate</span>
<span class="s2">cmo / select / mo_final </span>
<span class="s2">resetpts / itp </span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">production_mode</span><span class="p">:</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s1">&#39;dump / gmv / PRE_FINAL_MASSAGE / mo_final </span><span class="se">\n</span><span class="s1">&#39;</span>
        
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">## Massage Mesh Away from Intersection </span>
<span class="s2">pset / pref / attribute / dfield / 1,0,0 / lt / H_EPS </span>
<span class="s2">pset / pregion / attribute / dfield / 1,0,0 / gt / H_SCALE2 </span>
<span class="s2">pset / pboundary / attribute / itp / 1,0,0 / eq / 10 </span>
<span class="s2">pset / psmooth / not / pregion pref pboundary </span>
<span class="s2">#massage / H_SCALE / 1.e-5 / 1.e-5 / pset get pref / &amp; </span>
<span class="s2">#nosmooth / strictmergelenth</span>

<span class="s2">assign///maxiter_sm/1 </span>

<span class="s2">smooth / position / esug / pset get psmooth; recon 0; </span>
<span class="s2">smooth / position / esug / pset get psmooth; recon 0; </span>
<span class="s2">smooth / position / esug / pset get psmooth; recon 0; </span>

<span class="s2">assign///maxiter_sm/10</span>
<span class="s2">###########################################</span>
<span class="s2"># nodes for Intersection / Mesh Connectivity Check </span>
<span class="s2">cmo / copy / mo_final_check / mo_final</span>
<span class="s2">#</span>
<span class="s2"># Define variables that are hard wired for this part of the workflow</span>
<span class="s2">define / MO_TRI_MESH_SSINT / mo_tri_tmp_subset</span>
<span class="s2">define / MO_LINE_MESH_SSINT / mo_line_tmp_subset</span>
<span class="s2">define / ATT_ID_INTERSECTION_SSINT / b_a</span>
<span class="s2">define / ATT_ID_SOURCE_SSINT / id_node_global</span>
<span class="s2">define / ATT_ID_SINK_SSINT / id_node_tri</span>
<span class="s2">#</span>
<span class="s2"># Before subsetting the mesh reate a node attribute containing the integer global node number</span>
<span class="s2">cmo / set_id / mo_final_check / node / ATT_ID_SOURCE_SSINT</span>
<span class="s2">#</span>
<span class="s2"># Subset the triangle mesh based on b_a node attribute ne 0</span>
<span class="s2">#</span>
<span class="s2">cmo / select / mo_final_check</span>
<span class="s2">pset / pkeep / attribute / ATT_ID_INTERSECTION_SSINT / 1 0 0 / ne / 0</span>
<span class="s2">pset / pall / seq / 1 0 0</span>
<span class="s2">pset / pdel / not pall pkeep</span>
<span class="s2">rmpoint / pset get pdel / exclusive</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">#</span>
<span class="s2"># Create an integer node attribute in the line mesh to interpolate the triangle node number onto</span>
<span class="s2"># </span>
<span class="s2">cmo / addatt / mo_line_work / ATT_ID_SINK_SSINT / vint / scalar / nnodes</span>
<span class="s2">interpolate / voronoi / mo_line_work ATT_ID_SINK_SSINT / 1 0 0 / &amp;</span>
<span class="s2">                        mo_final_check  ATT_ID_SOURCE_SSINT</span>
<span class="s2">#</span>
<span class="s2"># Supress AVS output of a bunch of node attributes</span>
<span class="s2">#</span>
<span class="s2">cmo / modatt / mo_line_work / imt / ioflag / l</span>
<span class="s2">cmo / modatt / mo_line_work / itp / ioflag / l</span>
<span class="s2">cmo / modatt / mo_line_work / isn / ioflag / l</span>
<span class="s2">cmo / modatt / mo_line_work / icr / ioflag / l</span>
<span class="s2">cmo / modatt / mo_line_work / a_b / ioflag / l</span>
<span class="s2">cmo / modatt / mo_line_work / b_a / ioflag / l</span>
<span class="s2">#</span>
<span class="s2"># Output list of intersection nodes with the corrosponding node id number from the triangle mesh</span>

<span class="s2">dump / avs2 / OUTPUT_INTER_ID_SSINT / mo_line_work / 0 0 2 0</span>
<span class="s2">cmo / delete / mo_line_work</span>

<span class="s2">cmo / delete / mo_final_check</span>
<span class="s2"># nodes for intersection check over</span>

<span class="s2">cmo / select / mo_final </span>

<span class="s2">##### DEBUG</span>
<span class="s2"># write out mesh before it is rotate back into its final location</span>
<span class="s2"># Useful to compare with meshing workflow if something crashes</span>
<span class="s2">#dump / avs2 / tmp_mesh_2D.inp / mo_final / 1 1 1 0 </span>
<span class="s2">##### DEBUG</span>
<span class="s2"># Rotate facture back into original plane </span>
<span class="s2">rotateln / 1 0 0 / nocopy / X1, Y1, Z1 / X2, Y2, Z2 / THETA / 0.,0.,0.,/  </span>
<span class="s2">cmo / printatt / mo_final / -xyz- / minmax </span>
<span class="s2">recon 1 </span>

<span class="s2">resetpts / itp </span>

<span class="s2">cmo / addatt / mo_final / unit_area_normal / xyz / vnorm </span>
<span class="s2">cmo / addatt / mo_final / scalar / xnorm ynorm znorm / vnorm </span>
<span class="s2">cmo / DELATT / mo_final / vnorm </span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="c1"># Clean up before output to GMV/AVS</span>
        <span class="k">if</span> <span class="n">production_mode</span><span class="p">:</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo / DELATT / mo_final / x_four </span>
<span class="s2">cmo / DELATT / mo_final / fac_n </span>
<span class="s2">cmo / DELATT / mo_final / rf_field_name </span>
<span class="s2">cmo / DELATT / mo_final / xnorm </span>
<span class="s2">cmo / DELATT / mo_final / ynorm </span>
<span class="s2">cmo / DELATT / mo_final / znorm </span>
<span class="s2">cmo / DELATT / mo_final / a_b </span>
<span class="s2">cmo / setatt / mo_final / ipolydat / no </span>
<span class="s2">cmo / modatt / mo_final / icr1 / ioflag / l </span>
<span class="s2">cmo / modatt / mo_final / isn1 / ioflag / l </span>
<span class="s2">    </span>
<span class="s2"># Create Family element set</span>
<span class="s2">cmo / addatt / mo_final / family_id / vint / scalar / nelements </span>
<span class="s2">cmo / setatt / mo_final / family_id / 1 0 0 / FAMILY</span>
<span class="s2">    </span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">dump / OUTFILE_AVS / mo_final</span>
<span class="s2">dump / lagrit / OUTFILE_LG / mo_final</span>
<span class="s2">&quot;&quot;&quot;</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo / setatt / mo_pts / imt / 1 0 0 / ID </span>
<span class="s2">cmo / setatt / mo_pts / itetclr / 1 0 0 / ID </span>
<span class="s2">resetpts / itp </span>

<span class="s2">cmo / setatt / mo_line_work / imt / 1 0 0 / ID </span>
<span class="s2">cmo / setatt / mo_line_work / itetclr / 1 0 0 / ID</span>

<span class="s2">addmesh / merge / mo_final / mo_pts / mo_line_work </span>
<span class="s2">cmo / delete / mo_pts </span>
<span class="s2">cmo / delete / mo_line_work </span>
<span class="s2">    </span>
<span class="s2"># Create Family element set</span>
<span class="s2">cmo / addatt / mo_final / family_id / vint / scalar / nelements </span>
<span class="s2">cmo / setatt / mo_final / family_id / 1 0 0 / FAMILY</span>

<span class="s2">cmo / select / mo_final </span>
<span class="s2"># Rotate </span>
<span class="s2">rotateln / 1 0 0 / nocopy / X1, Y1, Z1 / X2, Y2, Z2 / THETA / 0.,0.,0.,/ </span>

<span class="s2">cmo / printatt / mo_final / -xyz- / minmax </span>
<span class="s2">cmo / modatt / mo_final / icr1 / ioflag / l </span>
<span class="s2">cmo / modatt / mo_final / isn1 / ioflag / l</span>
<span class="s2">dump / lagrit / OUTFILE_LG / mo_final </span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">quality </span>
<span class="s2">cmo / delete / mo_final </span>
<span class="s2">cmo / status / brief </span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="c1"># Create a different Run file for each CPU</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncpu</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;mesh_poly_CPU</span><span class="si">%d</span><span class="s1">.lgi&#39;</span><span class="o">%</span><span class="n">i</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1">#Name of parameter Input File</span>
        <span class="n">fparameter_name</span> <span class="o">=</span> <span class="s1">&#39;parameters_CPU</span><span class="si">%d</span><span class="s1">.mlgi&#39;</span><span class="o">%</span><span class="n">i</span> 
        <span class="n">fintersection_name</span> <span class="o">=</span> <span class="s1">&#39;intersections_CPU</span><span class="si">%d</span><span class="s1">.inp&#39;</span><span class="o">%</span><span class="n">i</span>
        <span class="n">fpoly_name</span> <span class="o">=</span> <span class="s1">&#39;poly_CPU</span><span class="si">%d</span><span class="s1">.inp&#39;</span><span class="o">%</span><span class="n">i</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span><span class="n">fparameter_name</span><span class="p">,</span> <span class="n">fpoly_name</span><span class="p">,</span> <span class="n">fintersection_name</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input</span><span class="o">%</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--&gt; Writing LaGriT Control Files: Complete&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="create_user_functions"><a class="viewcode-back" href="../../../pydfnworks.html#pydfnworks.dfnGen.lagrit_scripts.create_user_functions">[docs]</a><span class="k">def</span> <span class="nf">create_user_functions</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Create user_function.lgi files for meshing</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        None</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    These functions are called within LaGriT. It controls the mesh resolution using slope and refine_dist</span>

<span class="sd">    &quot;&quot;&quot;</span>


    <span class="c1"># user_function.lgi useing PARAM_A and PARAM_B for slope and intercept</span>
    <span class="n">lagrit_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo/DELATT/mo_pts/dfield</span>
<span class="s2">compute / distance_field / mo_pts / mo_line_work / dfield</span>
<span class="s2">math/multiply/mo_pts/x_four/1,0,0/mo_pts/dfield/PARAM_A/</span>
<span class="s2">math/add/mo_pts/x_four/1,0,0/mo_pts/x_four/PARAM_B/</span>
<span class="s2">cmo/copyatt/mo_pts/mo_pts/fac_n/x_four</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;user_function.lgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># user_function2.lgi uses PARAM_A2 and PARAM_B2 for slope and intercept</span>
    <span class="n">lagrit_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo/DELATT/mo_pts/dfield</span>
<span class="s2">compute / distance_field / mo_pts / mo_line_work / dfield</span>
<span class="s2">math/multiply/mo_pts/x_four/1,0,0/mo_pts/dfield/PARAM_A2/</span>
<span class="s2">math/add/mo_pts/x_four/1,0,0/mo_pts/x_four/PARAM_B2/</span>
<span class="s2">cmo/copyatt/mo_pts/mo_pts/fac_n/x_four</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;user_function2.lgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<div class="viewcode-block" id="create_merge_poly_files"><a class="viewcode-back" href="../../../pydfnworks.html#pydfnworks.dfnGen.lagrit_scripts.create_merge_poly_files">[docs]</a><span class="k">def</span> <span class="nf">create_merge_poly_files</span><span class="p">(</span><span class="n">ncpu</span><span class="p">,</span> <span class="n">num_poly</span><span class="p">,</span> <span class="n">fracture_list</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">visual_mode</span><span class="p">,</span> <span class="n">domain</span><span class="p">,</span> <span class="n">flow_solver</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Creates a LaGriT script that reads in each fracture mesh, appends it to the main mesh, and then deletes that mesh object. Then duplicate points are removed from the main mesh using EPS_FILTER.  The points are compressed, and then written to file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        ncpu : int </span>
<span class="sd">            Number of Processors used for meshing</span>
<span class="sd">        fracture_list : list of int</span>
<span class="sd">            List of fracture numbers in the DFN</span>
<span class="sd">        h : float </span>
<span class="sd">            Meshing length scale</span>
<span class="sd">        visual_mode : bool</span>
<span class="sd">            If True, reduced_mesh.inp will be output. If False, full_mesh.inp is output</span>
<span class="sd">        domain : dict</span>
<span class="sd">            Dictionary of x,y,z domain size</span>
<span class="sd">        flow_solver : string</span>
<span class="sd">            Name of target flow solver (Changes output files)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        endis : list of int</span>
<span class="sd">            Number of last fracture merged into a partition of the DFN</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    1. Fracture mesh objects are read into different part_*.lg files. This allows for merging of the mesh to be performed in batches.  </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Writing : merge_poly.lgi&quot;</span><span class="p">)</span>
    <span class="n">part_size</span> <span class="o">=</span> <span class="n">num_poly</span><span class="o">/</span><span class="n">ncpu</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">###v number of fractures in each part</span>
    <span class="n">endis</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fracture_list</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>    
        <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>    
        <span class="k">if</span> <span class="n">ii</span> <span class="o">==</span> <span class="n">part_size</span><span class="p">:</span>
            <span class="n">endis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>    
    <span class="n">endis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fracture_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">lagrit_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Change to read LaGriT</span>
<span class="s2">read / lagrit /  </span><span class="si">%s</span><span class="s2"> / mo_</span><span class="si">%d</span><span class="s2"> / binary</span>
<span class="s2">cmo / move / mo_</span><span class="si">%d</span><span class="s2"> / mo_final </span>
<span class="s2">define / MO_NAME_FRAC / mo_</span><span class="si">%d</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visual_mode</span><span class="p">:</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo / addatt / MO_NAME_FRAC / volume / evol_one</span>
<span class="s2">math / sum / MO_NAME_FRAC / evol_sum / 1 0 0 / MO_NAME_FRAC / evol_one </span>
<span class="s2">&quot;&quot;&quot;</span> 
    <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">addmesh / merge / cmo_tmp / cmo_tmp / mo_</span><span class="si">%d</span><span class="s2"></span>
<span class="s2">cmo / delete / mo_</span><span class="si">%d</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">lagrit_input_2</span> <span class="o">=</span> <span class="s1">&#39;#Writing out merged fractures</span><span class="se">\n</span><span class="s1">&#39;</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visual_mode</span><span class="p">:</span>
        <span class="n">lagrit_input_2</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">mo / addatt/ cmo_tmp / volume / evol_all</span>
<span class="s2">math / sum / cmo_tmp / evol_sum / 1 0 0 / cmo_tmp / evol_all &quot;&quot;&quot;</span>
    <span class="n">lagrit_input_2</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span>
<span class="s2">cmo select cmo_tmp</span>
<span class="s2">dump lagrit part</span><span class="si">%d</span><span class="s2">.lg cmo_tmp</span>
<span class="s2">finish </span><span class="se">\n</span><span class="s2"> </span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Counter for cpus </span>
    <span class="n">fout</span> <span class="o">=</span> <span class="s1">&#39;merge_poly_part_1.lgi&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fout</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fracture_list</span><span class="p">:</span> 
        <span class="n">tmp</span> <span class="o">=</span> <span class="s1">&#39;mesh_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;.lg&#39;</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input</span><span class="o">%</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
        <span class="c1"># if i is the last fracture in the cpu set</span>
        <span class="c1"># move to the next cpu set    </span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">endis</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input_2</span><span class="o">%</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">fout</span> <span class="o">=</span> <span class="s1">&#39;merge_poly_part_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.lgi&#39;</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fout</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> 

    <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span> 
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fout</span><span class="p">)</span> <span class="c1">###</span>

    <span class="c1">## Write LaGriT file for merge parts of the mesh and remove duplicate points </span>

    <span class="n">lagrit_input</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">read / lagrit / part</span><span class="si">%d</span><span class="s2">.lg / junk / binary</span>
<span class="s2">addmesh / merge / mo_all / mo_all / cmo_tmp </span>
<span class="s2">cmo / delete / cmo_tmp </span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;merge_rmpts.lgi&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">endis</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input</span><span class="o">%</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>

    <span class="c1"># Append meshes complete</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visual_mode</span><span class="p">:</span> 
        <span class="n">lagrit_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Appending the meshes complete </span>
<span class="s2"># LaGriT Code to remove duplicates and output the mesh</span>
<span class="s2">cmo / select / mo_all </span>
<span class="s2">#recon 1</span>
<span class="s2">define / EPS / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">define / EPS_FILTER / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">pset / pinter / attribute / dfield / 1,0,0 / lt / EPS </span>
<span class="s2">#cmo / addatt / mo_all / inter / vint / scalar / nnodes </span>
<span class="s2">#cmo / setatt / mo_all / inter / 1 0 0 / 0 </span>
<span class="s2">#cmo / setatt / mo_all / inter / pset, get, pinter / 1 </span>

<span class="s2">filterkd / pset get pinter / EPS_FILTER / nocheck</span>
<span class="s2">pset / pinter / delete</span>

<span class="s2">rmpoint / compress </span>
<span class="s2"># SORT can affect a_b attribute</span>
<span class="s2">sort / mo_all / index / ascending / ikey / imt xic yic zic </span>
<span class="s2">reorder / mo_all / ikey </span>
<span class="s2">cmo / DELATT / mo_all / ikey</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">h</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">,</span> <span class="n">h</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span>
<span class="s2">resetpts / itp </span>
<span class="s2">boundary_components </span>
<span class="s2">#dump / full_mesh.gmv / mo_all</span>
<span class="s2">dump / full_mesh.inp / mo_all</span>
<span class="s2">dump / lagrit / full_mesh.lg / mo_all</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">flow_solver</span> <span class="o">==</span> <span class="s2">&quot;PFLOTRAN&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dumping output for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">flow_solver</span><span class="p">)</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">dump / pflotran / full_mesh / mo_all / nofilter_zero</span>
<span class="s2">dump / stor / full_mesh / mo_all / ascii</span>
<span class="s2">    &quot;&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">flow_solver</span> <span class="o">==</span> <span class="s2">&quot;FEHM&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dumping output for </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">flow_solver</span><span class="p">)</span>
            <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">dump / stor / full_mesh / mo_all / ascii</span>
<span class="s2">dump / coord / full_mesh / mo_all </span>
<span class="s2"># matid start at 1, but we need them to start at 7 for FEHM due to zone files</span>
<span class="s2"># So we do a little addition</span>
<span class="s2">math / add / mo_all / imt1 / 1,0,0 / mo_all / imt1 / 6</span>
<span class="s2">dump / zone_imt / full_mesh / mo_all</span>
<span class="s2"># and then we subtract 6 back </span>
<span class="s2">math / subtract / mo_all / imt1 / 1,0,0 / mo_all / imt1 / 6</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING!!!!!!!</span><span class="se">\n</span><span class="s2">Unkown flow solver selection: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">flow_solver</span><span class="p">)</span>
        <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot; </span>
<span class="s2"># Dump out Material ID Dat file</span>
<span class="s2">cmo / modatt / mo_all / isn / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / x_four / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / fac_n / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / dfield / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / rf_field / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / a_b / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / b_a / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / xnorm / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / ynorm / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / znorm / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / evol_one / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / evol_all / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / numbnd / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / id_numb / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / evol_all / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / itp / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / icr / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / meshid / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / id_n_1 / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / id_n_2 / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / pt_gtg / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / pt_gtg / ioflag / l</span>
<span class="s2"># Dump out Material ID Dat file</span>
<span class="s2">dump / avs2 / materialid.dat / mo_all / 0 0 2 0</span>

<span class="s2">cmo / modatt / mo_all / imt1 / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / family_id / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / evol_onen / ioflag / l</span>
<span class="s2"># Dump mesh with no attributes for viz</span>
<span class="s2">dump / full_mesh_viz.inp / mo_all</span>

<span class="s2"># Dump out zone files</span>
<span class="s2">define / XMAX / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">define / XMIN / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">define / YMAX / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">define / YMIN / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">define / ZMAX / </span><span class="si">%e</span><span class="s2"> </span>
<span class="s2">define / ZMIN / </span><span class="si">%e</span><span class="s2"> </span>

<span class="s2">define / ZONE / 1</span>
<span class="s2">define / FOUT / boundary_top</span>
<span class="s2">pset / top / attribute / zic / 1,0,0/ gt / ZMAX</span>
<span class="s2">pset / top / zone / FOUT/ ascii / ZONE</span>

<span class="s2">define / ZONE / 2</span>
<span class="s2">define / FOUT / boundary_bottom</span>
<span class="s2">pset / bottom / attribute / zic / 1,0,0/ lt / ZMIN</span>
<span class="s2">pset / bottom / zone / FOUT/ ascii / ZONE</span>

<span class="s2">define / ZONE / 3</span>
<span class="s2">define / FOUT / boundary_left_w</span>
<span class="s2">pset / left_w / attribute/ xic/ 1,0,0 /lt / XMIN</span>
<span class="s2">pset / left_w / zone / FOUT/ ascii / ZONE</span>

<span class="s2">define / ZONE / 4</span>
<span class="s2">define / FOUT / boundary_front_n</span>
<span class="s2">pset / front_n / attribute/ yic / 1,0,0 / gt / YMAX</span>
<span class="s2">pset / front_n / zone / FOUT/ ascii / ZONE</span>

<span class="s2">define / ZONE / 5</span>
<span class="s2">define / FOUT / boundary_right_e</span>
<span class="s2">pset / right_e / attribute/ xic / 1,0,0/ gt / XMAX</span>
<span class="s2">pset / right_e / zone / FOUT/ ascii / ZONE</span>

<span class="s2">define / ZONE / 6</span>
<span class="s2">define / FOUT / boundary_back_s</span>
<span class="s2">pset / back_s / attribute/ yic/ 1,0,0 / lt / YMIN</span>
<span class="s2">pset / back_s / zone / FOUT/ ascii / ZONE</span>

<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="n">h</span><span class="o">*</span><span class="mi">10</span><span class="o">**-</span><span class="mi">3</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> \
            <span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> \
            <span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span>

        <span class="n">lagrit_input</span><span class="o">=</span><span class="n">lagrit_input</span><span class="o">%</span><span class="n">parameters</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">lagrit_input</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo / modatt / mo_all / icr1 / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / isn1 / ioflag / l</span>
<span class="s2">cmo / modatt / mo_all / itp1 / ioflag / l</span>
<span class="s2">#dump / reduced_mesh.gmv / mo_all </span>
<span class="s2">dump / reduced_mesh.inp / mo_all</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">lagrit_input</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">quality </span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_input</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">endis</span><span class="p">)</span></div>

<div class="viewcode-block" id="define_zones"><a class="viewcode-back" href="../../../pydfnworks.html#pydfnworks.dfnGen.lagrit_scripts.define_zones">[docs]</a><span class="k">def</span> <span class="nf">define_zones</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Processes zone files for particle tracking. All zone files are combined into allboundaries.zone </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        None </span>
<span class="sd">    &quot;&quot;&quot;</span>    
   
    <span class="n">fall</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;allboundaries.zone&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="c1">#copy all but last 2 lines of boundary_top.zone in allboundaries.zone</span>
    <span class="n">fzone</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;boundary_top.zone&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">fzone</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">fzone</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 
    <span class="n">fall</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="c1">#copy all but frist and last 2 lines of boundary_bottom.zone in allboundaries.zone</span>
    <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="s1">&#39;left_w&#39;</span><span class="p">,</span><span class="s1">&#39;front_n&#39;</span><span class="p">,</span><span class="s1">&#39;right_e&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">fzone</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;boundary_</span><span class="si">%s</span><span class="s2">.zone&quot;</span><span class="o">%</span><span class="n">f</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">=</span><span class="n">fzone</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">fzone</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 
            <span class="n">fall</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">fzone</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;boundary_back_s.zone&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">fzone</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">lines</span><span class="o">=</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">fzone</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> 
    <span class="n">fall</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">fall</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1"># copies boundary zone files for PFLOTRAN </span>
    <span class="c1"># This can be deleted once we clean up the flow </span>
    <span class="n">move</span><span class="p">(</span><span class="s1">&#39;boundary_bottom.zone&#39;</span><span class="p">,</span><span class="s1">&#39;pboundary_bottom.zone&#39;</span><span class="p">)</span>
    <span class="n">move</span><span class="p">(</span><span class="s1">&#39;boundary_left_w.zone&#39;</span><span class="p">,</span><span class="s1">&#39;pboundary_left_w.zone&#39;</span><span class="p">)</span>
    <span class="n">move</span><span class="p">(</span><span class="s1">&#39;boundary_front_n.zone&#39;</span><span class="p">,</span><span class="s1">&#39;pboundary_front_n.zone&#39;</span><span class="p">)</span>
    <span class="n">move</span><span class="p">(</span><span class="s1">&#39;boundary_right_e.zone&#39;</span><span class="p">,</span><span class="s1">&#39;pboundary_right_e.zone&#39;</span><span class="p">)</span>
    <span class="n">move</span><span class="p">(</span><span class="s1">&#39;boundary_back_s.zone&#39;</span><span class="p">,</span><span class="s1">&#39;pboundary_back_s.zone&#39;</span><span class="p">)</span>
    <span class="n">move</span><span class="p">(</span><span class="s1">&#39;boundary_top.zone&#39;</span><span class="p">,</span><span class="s1">&#39;pboundary_top.zone&#39;</span><span class="p">)</span></div>
 
    <span class="c1">## Remove Left over zone files</span>
    <span class="c1">#os.remove(&#39;boundary_bottom.zone&#39;)</span>
    <span class="c1">#os.remove(&#39;boundary_top.zone&#39;)</span>
    <span class="c1">#os.remove(&#39;boundary_left_w.zone&#39;)</span>
    <span class="c1">#os.remove(&#39;boundary_right_e.zone&#39;)</span>
    <span class="c1">#os.remove(&#39;boundary_front_n.zone&#39;)</span>
    <span class="c1">#os.remove(&#39;boundary_back_s.zone&#39;)</span>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, LANL, LA-UR-17-22216

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>